<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prototipo PET 2D – Juego accesible</title>
  <link rel="stylesheet" href="styles.css">
  <script src="app.js" type="module" defer></script>
</head>
<body>
  <a class="skip-link" href="#contenido-principal">Saltar al contenido principal</a>
  <header class="site-header">
    <div class="branding">
      <p class="eyebrow">Prototipo accesible</p>
      <h1>Juego de recolección de PET</h1>
      <p class="lede">Controla el bote, recoge PET y vacíalo para enviarlo al almacenamiento.</p>
    </div>
  </header>

  <main id="contenido-principal" class="layout" aria-labelledby="titulo-juego">
    <section class="game-panel" aria-labelledby="titulo-juego">
      <div class="section-header">
        <h2 id="titulo-juego">Simulación 2D en Canvas</h2>
        <p class="lede">Movimientos con teclado o botones en pantalla. Vacía el bote para liberar capacidad.</p>
      </div>
      <div class="game-wrapper" role="group" aria-label="Área de juego">
        <canvas id="juego-canvas" width="960" height="540" role="img" aria-label="Minijuego de recolección de PET"></canvas>
        <div class="controls" aria-label="Controles del bote">
          <button type="button" id="mover-izquierda" aria-keyshortcuts="ArrowLeft" aria-label="Mover bote a la izquierda">⟵ Izquierda</button>
          <button type="button" id="vaciar-bote" aria-keyshortcuts="Space" aria-label="Vaciar bote y enviar al almacenamiento">Vaciar bote</button>
          <button type="button" id="mover-derecha" aria-keyshortcuts="ArrowRight" aria-label="Mover bote a la derecha">Derecha ⟶</button>
        </div>
      </div>
    </section>

    <section class="status-panel" aria-labelledby="titulo-estado">
      <div class="section-header">
        <h2 id="titulo-estado">Estado del bote y contaminación</h2>
        <p class="lede">Capacidad, contaminación acumulada y conteo en almacenamiento.</p>
      </div>
      <dl class="hud" aria-live="polite">
        <div>
          <dt>Capacidad actual</dt>
          <dd id="hud-capacidad-actual">0</dd>
        </div>
        <div>
          <dt>Capacidad máxima</dt>
          <dd id="hud-capacidad-maxima">0</dd>
        </div>
        <div>
          <dt>Nivel de contaminación</dt>
          <dd id="hud-contaminacion">0%</dd>
        </div>
      </dl>
      <section class="storage" aria-labelledby="titulo-almacenamiento">
        <h3 id="titulo-almacenamiento">Almacenamiento</h3>
        <div class="storage-grid">
          <article aria-labelledby="materiales-sin-procesar" class="storage-card">
            <h4 id="materiales-sin-procesar">Materiales sin procesar (PET)</h4>
            <ul>
              <li>Transparente: <span id="hud-pet-transparente">0</span></li>
              <li>Azul: <span id="hud-pet-azul">0</span></li>
              <li>Verde: <span id="hud-pet-verde">0</span></li>
              <li>Dorado: <span id="hud-pet-dorado">0</span></li>
            </ul>
          </article>
          <article aria-labelledby="componentes-titulo" class="storage-card">
            <h4 id="componentes-titulo">Componentes</h4>
            <p><span id="hud-componentes">0</span> unidades</p>
          </article>
          <article aria-labelledby="maquinaria-titulo" class="storage-card">
            <h4 id="maquinaria-titulo">Maquinaria</h4>
            <p><span id="hud-maquinaria">0</span> equipos</p>
          </article>
        </div>
      </section>
    </section>

    <section class="garden-panel" aria-labelledby="titulo-jardin">
      <div class="section-header">
        <h2 id="titulo-jardin">Jardín emergente 42x42</h2>
        <p class="lede">Cada celda es tierra con humedad, nutrientes y compactación. Una especie pionera se expande según las condiciones.</p>
      </div>
      <div class="game-wrapper" role="group" aria-label="Simulación de jardín">
        <canvas id="garden-canvas" width="504" height="504" role="img" aria-label="Jardín emergente de 42 por 42 celdas"></canvas>
        <div class="garden-hud" aria-live="polite">
          <div>
            <p class="hud-label">Cobertura vegetal</p>
            <p id="hud-cobertura" class="hud-value">0%</p>
          </div>
          <div>
            <p class="hud-label">Humedad media</p>
            <p id="hud-humedad" class="hud-value">0</p>
          </div>
          <div>
            <p class="hud-label">Nutrientes medios</p>
            <p id="hud-nutrientes" class="hud-value">0</p>
          </div>
          <div>
            <p class="hud-label">Plantas sanas</p>
            <p id="hud-salud" class="hud-value">0</p>
          </div>
        </div>
      </div>
      <article class="rules" aria-labelledby="titulo-reglas">
        <h3 id="titulo-reglas">Reglas y justificación</h3>
        <p>La primera especie es <strong>trébol blanco</strong> (Trifolium repens) porque fija nitrógeno, tolera suelos compactados y forma mantos densos, ideal para observar patrones emergentes.</p>
        <ul>
          <li><strong>Estado del suelo:</strong> cada celda guarda humedad, nutrientes, compactación y temperatura. Estos valores fluctúan levemente en cada ciclo.</li>
          <li><strong>Crecimiento:</strong> una planta consume humedad y nutrientes. Si hay suficientes recursos y entre 2 y 4 vecinos vivos, crece más rápido; la compactación y el calor reducen su energía.</li>
          <li><strong>Propagación:</strong> cuando una planta acumula energía alta y el suelo es fértil, lanza semillas a celdas adyacentes vacías con probabilidad proporcional a los recursos.</li>
          <li><strong>Estrés y muerte:</strong> la sequía, la falta de nutrientes o la compactación extrema agotan la energía y la planta muere, liberando materia orgánica que fertiliza la celda.</li>
          <li><strong>Playera mínima:</strong> el jugador observa las métricas y puede imaginar acciones futuras (regar, aportar composta) que modificarían humedad y nutrientes sin microgestión constante.</li>
        </ul>
        <p>El diseño prioriza variables reales (agua, nutrientes, compactación) para conectar con sensores físicos en el futuro y mantener una simulación intuitiva basada en la ecología del suelo.</p>
      </article>
    </section>
  </main>

  <footer class="site-footer">
    <p>Prototipo funcional enfocado en accesibilidad, rendimiento y jugabilidad móvil.</p>
    <p>Controles: teclas de flecha o botones en pantalla. Espacio para vaciar.</p>
  </footer>
</body>
</html>
